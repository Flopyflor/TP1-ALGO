\documentclass[10pt,a4paper]{article}

\input{AEDmacros}
\usepackage{caratula} % Version modificada para usar las macros de algo1 de ~> https://github.com/bcardiff/dc-tex


\titulo{IDK chicos, un título}
\subtitulo{Subtítulo del tp}

\fecha{\today}

\materia{Algoritmos}
\grupo{losdecompusongentedebien}

\integrante{Allami, Florencia}{484/23}{allamiflorencia@gmail.com}
\integrante{Bartoli, Matilda}{175/23}{bartoli.matilda@gmail.com}
\integrante{Apellido, Nombre3}{003/01}{email3@dominio.com}
\integrante{Apellido, Nombre4}{004/01}{email4@dominio.com}
% Pongan cuantos integrantes quieran

% Declaramos donde van a estar las figuras
% No es obligatorio, pero suele ser comodo
\graphicspath{{../static/}}

\begin{document}

\maketitle

\section{Ejercicio 1}

\subsection{redistribucionDeLosFrutos}

% TODO: acá dejé en el asegura un \res y varios result... el paquete que nos dieron los profes define res, usamos eso no? o prefieren result?
\begin{proc}{redistribucionDeLosFrutos}{\In recursos: \TLista{\float}, \In cooperan: \TLista{\bool}}{\TLista{\float}}
	\requiere{\paraTodo[unalinea]{e}{\float}{e \in recursos \implica e \ge 0} \land \longitud{cooperan} = \longitud{recursos}}
	\asegura{|\res| = |recursos| \yLuego \paraTodo{i}{\ent}{0 <= i \le |result| \implicaLuego \IfThenElse{cooperan[i] = \True}{result[i] = \frac{fondoComun(recursos, cooperan)}{\longitud{recursos}}}{result[i] = recursos[i] + \frac{fondoComun(recursos, cooperan)}{\longitud{recursos}}}}} 
\end{proc}

\aux{fondoComun}{recursos: \TLista{\float}, cooperan: \TLista{\bool}}{\float}{
	\sum\limits_{i=0}^{\longitud{recursos}-1} \IfThenElse{cooperan[i] = \True}{recursos[i]}{0}
}

\subsection{trayectoriaDeLosFrutosIndividualesALargoPlazo}

\begin{proc}{trayectoriaDeLosFrutosIndividualesALargoPlazo}{
	\Inout trayectorias: \TLista{\TLista{\float}}, \In cooperan: \TLista{\bool}, \In apuestas: \TLista{\TLista{\float}},
	\In pagos: \TLista{\TLista{\float}}, \In eventos: \TLista{\TLista{\nat}}
}{}
	\requiere{
		|trayectorias| = |eventos| = |cooperan| = |apuestas| = |pagos| \yLuego \\
		\paraTodo[unalinea]{i}{\ent}{0 \le i < |cooperan| \implicaLuego |trayectorias[i]| = 1 \land |apuestas[i]| = |pagos[i]|} \land \\
		% TODO: querémos que todos los individuos apuesten a la misma cantidad de eventos?
		todosElementosDeLasListasPositivos(pagos) \land todosElementosDeLasListasPositivos(trayectorias) \land \\
		eventosValidos(eventos, pagos) \land seApuestaTodo(apuestas)
	}
	\asegura{
		|trayectorias| = |eventos| \yLuego \\
		\paraTodo[unalinea]{i}{\ent}{0 \le i < |trayectorias| \implicaLuego |trayectorias[i]| = |eventos[0]|+1} \land \\
		% TODO: acá está el 0 pq todos tienen la misma cantidad de eventos. 
		% si les hace ruido podemos cambiarlo a eventos[i] y agregar otra sentencia 
		% que verifique que sea la misma cantidad de eventos para cada individuo. 
		% ...En realidad, no encuentro ninguna parte de la consigna que diga que 
		% tiene que ser la misma cantidad de eventos para cada individuo? pero, sino 
		% no tiene mucho sentido, no? cómo afectaría al fondo común sino?
		elPrincipioSigueIgual(old(trayectorias), trayectorias) \land \\
		estaBienCalculado(trayectorias, eventos, cooperan, apuestas, pagos)
	}

\end{proc}

\pred{todosElementosDeLasListasPositivos}{pagos: \TLista{\TLista{\float}}}{
     \paraTodo{i}{\ent}{\paraTodo{t}{\ent}{0 \leq i<|pagos| \land 0\leq t <|pagos[i]|} \yLuego \\
     pagos[i][j] \geq 0}
}

% TODO: seApuestaTodo (apuestas suman 1)
% TODO: eventosValidos (indices válidos para pagos)

\pred{estaBienCalculado}{trayectorias: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\nat}}, 
cooperan: \TLista{\bool}, apuestas: \TLista{\TLista{\float}}, pagos: \TLista{\TLista{\float}}}{
	\paraTodo{i}{\ent}{\paraTodo{t}{\ent}{(0 \le i < |cooperan| \land 0 < t \le |eventos[0]|) \yLuego \\
	trayectorias[i][t] = calcularPlataConFondo(i, t, cooperan, apuestas, pagos, eventos, trayectorias)}}
}


\aux{calcularPlataConFondo}{individuo: \nat, tiempo: \nat, cooperan: \TLista{\bool}, apuestas: \TLista{\TLista{\float}}, 
pagos: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\nat}}, trayectorias: \TLista{\TLista{\float}}}{\float}{ \\
	\IfThenElse{cooperan[individuo] = \True}{fondoDistribuido(tiempo, apuestas, pagos, eventos, trayectorias, cooperan) \\}
	{nuevaPlataSinFondo(individuo, tiempo, apuestas, pagos, eventos, trayectorias) \\
	+ fondoDistribuido(tiempo, apuestas, pagos, eventos, trayectorias, cooperan)}
}


\aux{nuevaPlataSinFondo}{individuo: \nat, tiempo: \nat, apuestas: \TLista{\TLista{\float}}, 
pagos: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\nat}}, trayectorias: \TLista{\TLista{\float}}}
{\float}{
	apuesta[individuo][eventos[individuo][tiempo]] * pagos[individuo][eventos[individuo][tiempo]] \times trayectorias[individuo][tiempo - 1]
	% TODO:  cual prefieren? \times o *?
	% TODO: si quieren cambiar eventos[individuo][tiempo] 
	% por algo más legible están invitados lol. Por ahí si cambiamos la entrada a <evento> directo?
}

\aux{fondoDistribuido}{tiempo: \ent, apuestas: \TLista{\TLista{\float}}, pagos: \TLista{\TLista{\float}}, 
eventos: \TLista{\TLista{\ent}}, trayectorias: {\TLista{\TLista{\float}}}, cooperan: \TLista{\bool}}{\float}{ \\
	\sum\limits_{i=0}^{|cooperan|-1}{\IfThenElse{cooperan[i] = \True \\}
	{\frac{nuevaPlataSinFondo(i, tiempo, apuestas, pagos, eventos, trayectorias)}{|cooperan|} \\}{0}}
	% TODO: van a notar que puse la división acá. para no ponerla tanto arriba, que re no entraba nada.
	% TODO: hay que encontrar la forma de poner un linebreak o algo acá pq no se lee :(
}

\subsection{trayectoriaExtrañaEscalera}
\subsection{individuoDecideSiCooperarONo}

\aux{fondoEnTurno}{turno: \ent, eventos: \TLista{\TLista{\ent}}, cooperan: \TLista{\bool}, 
recursos: \TLista{\float}, pagos: \TLista{\TLista{\float}}, apuestas: \TLista{\TLista{\float}}}{\float}{
	(\prod\limits_{k=0}^{turno}{tasasDeCooperadores(k, cooperan, pagos, apuestas)}) * \\ recursosDeCooperadoresIniciales(cooperan, recursos)
}

\aux{tasasDeCooperadores}{turno: \ent, cooperan: \TLista{\bool}, pagos: \TLista{\TLista{\float}}, apuestas: \TLista{\TLista{\float}, eventos: \TLista{\TLista{\ent}}}}{}{
	\\ \sum\limits_{i=0}^{|cooperan|-1}{\IfThenElse{cooperan[i] = \True}{\frac{tasaEnTurno(turno, i, pagos, apuestas, eventos)}{|cooperan|}}{0}}
}

\aux{recursosDeCooperadoresIniciales}{cooperan: \TLista{\bool}, recursos: \TLista{\float}}{\float}{
	\\ \sum\limits_{i=0}^{|cooperan|}{\IfThenElse{cooperan[i] = \True}{\frac{recursos[i]}{|cooperan|}}{0}}
}

\aux{tasaEnTurno}{turno: \ent, individuo: \ent, pagos: \TLista{\TLista{\float}}, 
apuestas: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\ent}}}{\float}{ \\
	pagos[individuo][eventos[individuo][turno]]*apuestas[individuo][eventos[individuo][turno]]
}

\aux{recursosDeNoCooperadorEnTurno}{turno: \ent, individuo: \ent, eventos: \TLista{\TLista{\ent}}, 
pagos: \TLista{\TLista{\float}}, apuestas: \TLista{\TLista{\float}}, cooperan: \TLista{\bool}}{}{
	recursos[individuo] * \prod\limits_{i=0}^{turno}{tasaEnTurno(turno, individuo, pagos, apuestas, eventos)} + \\
	\sum\limits_{i=0}^{turno}{(fondoEnTurno(i, eventos, cooperan, recursos, pagos, apuestas) \\ *
	\prod\limits_{j=i+1}^{turno}{tasaEnTurno(j, individuo, pagos, apuestas, eventos)})}
}


\end{document}
