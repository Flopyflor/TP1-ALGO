% !TEX encoding = UTF-8 Unicode
\documentclass[10pt,a4paper]{article}

\input{AEDmacros}
\usepackage{caratula} % Version modificada para usar las macros de algo1 de ~> https://github.com/bcardiff/dc-tex


\titulo{Trabajo práctico 1: Especificación y WP}
\subtitulo{“Fondo Monetario Común”}

\fecha{\today}

\materia{Algoritmos y Estructuras de Datos/ Ex Algo 2}
\grupo{losdecompusongentedebien}

\integrante{Allami, Florencia}{484/23}{allamiflorencia@gmail.com}
\integrante{Bartoli, Matilda}{175/23}{bartoli.matilda@gmail.com}
\integrante{Simon, Felipe Pedro}{135/23}{felipe.p.simon@gmail.com}
\integrante{Sosa, Luciano}{1011/23}{sosaluciano261@gmail.com}
% Pongan cuantos integrantes quieran

\graphicspath{{../static/}}

\begin{document}

\maketitle

\section{Ejercicio 1}

\subsection{redistribucionDeLosFrutos}

\begin{proc}{redistribucionDeLosFrutos}{\In recursos: \TLista{\float}, \In cooperan: \TLista{\bool}}{\TLista{\float}}
	\requiere{\paraTodo[unalinea]{e}{\float}{e \in recursos \implica e > 0} \land \longitud{cooperan} = \longitud{recursos}}
	\asegura{|\res| = |recursos| \yLuego \\ \paraTodo[unalinea]{i}{\ent}{0 \leq i < |\res| \implicaLuego \IfThenElse{cooperan[i] = \True}{res[i] = \frac{fondoComun(recursos, cooperan)}{\longitud{recursos}}}{res[i] = recursos[i] + \frac{fondoComun(recursos, cooperan)}{\longitud{recursos}}}}} 
\end{proc}

\aux{fondoComun}{recursos: \TLista{\float}, cooperan: \TLista{\bool}}{\float}{ \\\sum\limits_{i=0}^{\longitud{recursos}-1} \IfThenElse{cooperan[i] = \True}{recursos[i]}{0}
}

\subsection{trayectoriaDeLosFrutosIndividualesALargoPlazo}

\begin{proc}{trayectoriaDeLosFrutosIndividualesALargoPlazo}{
	\Inout trayectorias: \TLista{\TLista{\float}}, \In cooperan: \TLista{\bool}, \In apuestas: \TLista{\TLista{\float}},
	\In pagos: \TLista{\TLista{\float}}, \In eventos: \TLista{\TLista{\nat}}
}{}

	\requiere{\\
		|trayectorias| = |eventos| = |cooperan| = |apuestas| = |pagos| \yLuego \\
		\paraTodo[unalinea]{i}{\ent}{0 \le i < |cooperan| \implicaLuego |trayectorias[i]| = 1 \land |apuestas[i]| = |pagos[i]|} \land \\
		\paraTodo[unalinea]{i}{\ent}{0 \le i < |eventos| \implicaLuego |eventos[i]| = |eventos[0]|} \land \\
		todosElementosDeLasListasPositivos(pagos) \land \\ todosElementosDeLasListasPositivos(trayectorias) \land \\
		eventosValidos(eventos, pagos) \land \\seApuestaTodo(apuestas)\\
	}
	
	\asegura{\\
		|trayectorias| = |eventos| \yLuego \\
		\paraTodo[unalinea]{i}{\ent}{0 \le i < |trayectorias| \implicaLuego |trayectorias[i]| = |eventos[0]|+1} \land \\
		elPrincipioSigueIgual(old(trayectorias), trayectorias) \land \\
		estaBienCalculado(trayectorias, eventos, cooperan, apuestas, pagos)\\
	}

\end{proc}

\pred{todosElementosDeLasListasPositivos}{pagos: \TLista{\TLista{\float}}}{
     \paraTodo[unalinea]{i}{\ent}{\paraTodo[unalinea]{t}{\ent}{0 \leq i<|pagos| \land 0\leq t <|pagos[i]|} \implicaLuego pagos[i][j] > 0}
}

\pred{eventosValidos}{eventos: \TLista{\TLista{\nat}}, pagos: \TLista{\TLista{\float}}}{
	\paraTodo[unalinea]{i}{\ent}{\paraTodo[unalinea]{t}{\ent}{0 \leq i<|eventos| \land 0\leq t <|eventos[i]| \implicaLuego eventos[i][t]<|pagos[i]|}}
}

\pred {seApuestaTodo}{apuestas:\TLista{\TLista{\float}}}{
    \paraTodo[unalinea]{i}{\ent}{0 \leq i<|apuestas| \implicaLuego \sum\limits_{t=0}^{|apuestas[i]-1|}{apuestas[i][t]}=1}}

\pred{elPrincipioSigueIgual}{oldtrayectorias: \TLista{\TLista{\float}}, trayectorias:\TLista{\TLista{\float}}}{
	\paraTodo[unalinea]{i}{\ent}{0 \leq i < |trayectorias|  \implicaLuego 
	oldtrayectorias[i][0] = trayectorias [i][0]}
}

\pred{estaBienCalculado}{trayectorias: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\nat}}, 
cooperan: \TLista{\bool}, apuestas: \TLista{\TLista{\float}}, \\ pagos: \TLista{\TLista{\float}}}{
	\paraTodo[unalinea]{i}{\ent}{\paraTodo[unalinea]{t}{\ent}{(0 \leq i < |cooperan| \land 0 < t \le |eventos[0]|) \\ \implicaLuego 
	trayectorias[i][t] = calcularPlataConFondo(i, t, cooperan, apuestas, pagos, eventos, trayectorias)}}
}

\aux{calcularPlataConFondo}{individuo: \nat, tiempo: \nat, cooperan: \TLista{\bool}, apuestas: \TLista{\TLista{\float}}, 
pagos: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\nat}}, trayectorias: \TLista{\TLista{\float}}}{\float}{ \\
	\IfThenElse{cooperan[individuo] = \True}{fondoDistribuido(tiempo, apuestas, pagos, eventos, trayectorias, cooperan) \\}
	{nuevaPlataSinFondo(individuo, tiempo, apuestas, pagos, eventos, trayectorias) \\
	+ fondoDistribuido(tiempo, apuestas, pagos, eventos, trayectorias, cooperan)}
}

\aux{nuevaPlataSinFondo}{individuo: \nat, tiempo: \nat, apuestas: \TLista{\TLista{\float}}, 
pagos: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\nat}}, \\ trayectorias: \TLista{\TLista{\float}}}
{\float}{\\
	apuesta[individuo][eventos[individuo][tiempo]] * pagos[individuo][eventos[individuo][tiempo]] \\ *trayectorias[individuo][tiempo - 1]
}

\aux{fondoDistribuido}{tiempo: \ent, apuestas: \TLista{\TLista{\float}}, pagos: \TLista{\TLista{\float}}, 
eventos: \TLista{\TLista{\ent}}, trayectorias: {\TLista{\TLista{\float}}}, cooperan: \TLista{\bool}}{\float}{ \\
	\sum\limits_{i=0}^{|cooperan|-1}{\IfThenElse{cooperan[i] = \True \\}
	{\frac{nuevaPlataSinFondo(i, tiempo, apuestas, pagos, eventos, trayectorias)}{|cooperan|} \\}{0}}
}

\subsection{trayectoriaExtrañaEscalera}

\begin{proc}{trayectoriaExtrañaEscalera}{\In trayectoria: \TLista{\float}}{\bool}
	\requiere{|trayectoria| \geq 1}
	\asegura{\res = true \iff hayUnSoloMaximoLocal(trayectoria)} 
\end{proc}

\pred {hayUnSoloMaximoLocal}{trayectoria: \TLista{\float}}{
    \existe[unalinea]{i}{\ent}{0 \leq i<|trayectoria| \yLuego esMaximoLocal(i, trayectoria) \land \\ \neg \existe[unalinea]{j}{\ent}{0 \leq j<|trayectoria| \yLuego j \neq i \land esMaximoLocal(j, trayectoria)}}}

\pred {esMaximoLocal}{i: \ent, trayectoria: \TLista{\float}}{
    |trayectoria| = 1 \oLuego \\ (i = 0 \land trayectoria[0] > trayectoria[1]) \lor \\ (|trayectoria| \geq 3 \yLuego trayectoria[i - 1] < trayectoria[i] >trayectoria[i + 1]) \oLuego \\ (i = |trayectoria| - 1 \land trayectoria[|trayectoria| - 1] > trayectoria[|trayectoria| - 2])}

\subsection{individuoDecideSiCooperarONo}

\begin{proc}{individuoDecideSiCooperarONo}{\In individuo: \nat, \In recursos: \TLista{\float}, \Inout cooperan: \TLista{\bool},
 \In apuestas: \TLista{\TLista{\float}}, \In pagos: \TLista{\TLista{\float}}, \In eventos: \TLista{\TLista{\nat}}}{}
	\requiere{\\
		|pagos|=|apuestas|=|eventos|=|cooperan|=|recursos| \land 0 \le individuo < |cooperan| \yLuego \\
		\paraTodo[unalinea]{i}{\ent}{0 \le i < |apuestas| \implicaLuego |apuestas[i]| = |pagos[i]| \land |eventos[0]| = |eventos[i]|} \yLuego \\
		eventosValidos(eventos, pagos) \land \\
		todosElementosDeLasListasPositivos(pagos) \land \\
		todosElementosDeLasListasPositivos(apuestas) \land \\
		\paraTodo[unalinea]{i}{\ent}{0 \le i < |recursos| \implicaLuego recursos[i] > 0} \\ % TODO: habíamos dicho que recuros != 0 no?
		}
		\asegura{ \\
		|old(cooperan)| = |cooperan| \yLuego \\
		soloSeActualizoElIndividuo(individuo, old(cooperan), cooperan) \land \\
		\IfThenElse{cooperan[individuo] = \True \\}
		{fondoDivididoEnTurno(|eventos|, eventos, cooperanSiCoopera(individuo, cooperan), recursos, pagos, apuestas) \ge 
		recursosDeNoCooperadorEnTurno(|eventos|, individuo, eventos, pagos, apuestas, \\ cooperanSiNoCoopera(individuo, cooperan), recursos) \\}
		{fondoDivididoEnTurno(|eventos|, eventos, cooperanSiCoopera(individuo, cooperan), recursos, pagos, apuestas) \le 
		recursosDeNoCooperadorEnTurno(|eventos|, individuo, eventos, pagos, apuestas, \\ cooperanSiNoCoopera(individuo, cooperan), recursos) \\}\\
	}

\end{proc}

\pred{soloSeActualizoElIndividuo}{individuo, cooperanV, cooperanN}{
	\paraTodo[unalinea]{i}{\ent}{0 \le i < |cooperanV| \land i \neq individuo \implicaLuego cooperanV[i] = cooperanN[i]}
}

\aux{fondoDivididoEnTurno}{turno: \ent, eventos: \TLista{\TLista{\ent}}, cooperan: \TLista{\bool}, 
recursos: \TLista{\float}, pagos: \TLista{\TLista{\float}}, apuestas: \TLista{\TLista{\float}}}{\float}{\\
recursosDeCooperadoresIniciales(cooperan, recursos) * (\prod\limits_{k=0}^{turno}{tasasDeCooperadores(k, cooperan, pagos, apuestas)})
}
\aux{cooperanSiCoopera}{individuo, cooperan}{\TLista{\bool}}{
	\\ \sub{cooperan, 0, individuo} \masmas \langle \True \rangle \masmas \sub{cooperan, individuo, |cooperan|}
}

\aux{cooperanSiNoCoopera}{individuo, cooperan}{\TLista{\bool}}{
	\\ \sub{cooperan, 0, individuo} \masmas \langle \False \rangle \masmas \sub{cooperan, individuo, |cooperan|}
}

\aux{tasasDeCooperadores}{turno: \ent, cooperan: \TLista{\bool}, pagos: \TLista{\TLista{\float}}, apuestas: \TLista{\TLista{\float}, eventos: \TLista{\TLista{\ent}}}}{}{
	\\ \sum\limits_{i=0}^{|cooperan|-1}{\IfThenElse{cooperan[i] = \True}{\frac{tasaEnTurno(turno, i, pagos, apuestas, eventos)}{|cooperan|}}{0}}
}

\aux{recursosDeCooperadoresIniciales}{cooperan: \TLista{\bool}, recursos: \TLista{\float}}{\float}{
	\\ \sum\limits_{i=0}^{|cooperan|}{\IfThenElse{cooperan[i] = \True}{\frac{recursos[i]}{|cooperan|}}{0}}
}

\aux{tasaEnTurno}{turno: \ent, individuo: \ent, pagos: \TLista{\TLista{\float}}, 
apuestas: \TLista{\TLista{\float}}, eventos: \TLista{\TLista{\ent}}}{\float}{ \\
	pagos[individuo][eventos[individuo][turno]]*apuestas[individuo][eventos[individuo][turno]]
}

\aux{recursosDeNoCooperadorEnTurno}{turno: \ent, individuo: \ent, eventos: \TLista{\TLista{\ent}}, 
pagos: \TLista{\TLista{\float}}, apuestas: \TLista{\TLista{\float}}, cooperan: \TLista{\bool}, recursos: \TLista{\TLista{\float}}}{}{\\
	recursos[individuo] * \prod\limits_{i=0}^{turno}{tasaEnTurno(turno, individuo, pagos, apuestas, eventos)} + \\
	\sum\limits_{i=0}^{turno}{(fondoDivididoEnTurno(i, eventos, cooperan, recursos, pagos, apuestas)} *\\
 	\prod\limits_{j=i+1}^{turno}{tasaEnTurno(j, individuo, pagos, apuestas, eventos)} \text{)} 
	% TODO: no estoy pudiendo poner un linebreak acá pq está dentro de una sumatoria
}

\subsection{individuoActualizaApuesta}

\begin{proc}{individuoActualizaApuesta}{\In individuo: \nat, \In recursos: \TLista{\float} , \In cooperan: \TLista{\bool} , \Inout apuestas: \TLista{\TLista{\float}}, \In pagos: \TLista{\TLista{\float}} , \In eventos: \TLista{\TLista{\nat}} }{}


\end{proc}

\pred{esApuestaSimilar}{i: \nat, apuestas: \TLista{\TLista{\float}}, s: \TLista{\TLista{\float}}}{
	(|apuestas| = |s|) \land \paraTodo[unalinea]{j}{\ent}{(0 \leq j < |apuestas|) \land  (j \neq i) \implicaLuego ( apuestas[j] = s[j] )}
}
\section{Ejercicio 2}

\end{document}
